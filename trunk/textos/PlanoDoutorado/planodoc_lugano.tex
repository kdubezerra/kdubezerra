%
% exemplo genérico de uso da classe iiufrgs.cls
% $Id: iiufrgs.tex,v 4.6 2003/11/21 22:36:13 avila Exp $
%
\documentclass[plano-doutorado]{iiufrgs}
% um tipo específico de monografia pode ser informado como parâmetro opcional:
%\documentclass[tese]{iiufrgs}
% monografias em inglês devem receber o parâmetro `english':
%\documentclass[diss,english]{iiufrgs}
% a opção `openright' pode ser usada para forçar inícios de capítulos
% em páginas ímpares
% \documentclass[openright]{iiufrgs}
% para gerar uma versão somente-frente, basta utilizar a opção `oneside':
% \documentclass[oneside]{iiufrgs}
\usepackage[T1]{fontenc}        % pacote para conj. de caracteres correto
\usepackage[latin1]{inputenc}   % pacote para acentuação
\usepackage{graphicx}           % pacote para importar figuras
\usepackage{times}              % pacote para usar fonte Adobe Times
%\usepackage{mathptmx}          % p/ usar fonte Adobe Times nas fórmulas
\usepackage{algorithm}
\usepackage{algorithmic}

%\renewcommand{\labelenumii}{\alph{enumii}.}

\hyphenation{di-fe-ren-tes}
\hyphenation{re-qui-si-to}
\hyphenation{sa-tis-fa-tó-ria}
\hyphenation{a-tu-a-li-za-ções}
\hyphenation{res-trin-ge}
\hyphenation{pre-ci-sa-rão}
\hyphenation{to-le-rân-cia}
\hyphenation{vo-lun-tá-rios}
\hyphenation{com-pa-ti-bi-li-da-de}
\hyphenation{si-mu-la-ções}
\hyphenation{si-mu-la-ção}
\hyphenation{com-par-ti-lha-do}
\hyphenation{se-me-lhan-tes}
\hyphenation{e-co-no-mi-zar}
\hyphenation{ge-ren-cia-men-to}

%\renewcomd{\listalgorithmname}{Lista de Algoritmos}

%
% Informações gerais
%
\title{Um modelo de suporte distribuído para jogos MMOG em cenários com recursos computacionais limitados%Uma proposta de arquitetura híbrida (par-a-par e cliente-servidor) para jogos online maciçamente distribuídos 
}

\author{Benevides Bezerra}{Carlos Eduardo}
% alguns documentos podem ter varios autores:
%\author{Flaumann}{Frida Gutenberg}
%\author{Flaumann}{Klaus Gutenberg}

% orientador e co-orientador são opcionais (não diga isso pra eles :))
\advisor[Prof.~Dr.]{Resin Geyer}{Cláudio Fernando}
%\coadvisor[Prof.~Dr.]{Knuth}{Donald Ervin}

% a data deve ser a da defesa; se nao especificada, são gerados
% mes e ano correntes
\date{setembro}{2009}

% o nome do curso pode ser redefinido (ex. para TCs)
%\course{Curso de Especialização em Cachaça}

% o local de realização do trabalho pode ser especificado (ex. para TCs)
% com o comando \location:
%\location{Itaquaquecetuba}{SP}

% itens individuais da nominata podem ser redefinidos com os comandos
% abaixo:
% \renewcommand{\nominataReit}{Prof\textsuperscript{a}.~Wrana Maria Panizzi}
% \renewcommand{\nominataReitname}{Reitora}
% \renewcommand{\nominataPRE}{Prof.~Jos{\'e} Carlos Ferraz Hennemann}
% \renewcommand{\nominataPREname}{Pr{\'o}-Reitor de Ensino}
% \renewcommand{\nominataPRAPG}{Prof\textsuperscript{a}.~Joc{\'e}lia Grazia}
% \renewcommand{\nominataPRAPGname}{Pr{\'o}-Reitora Adjunta de P{\'o}s-Gradua{\c{c}}{\~a}o}
% \renewcommand{\nominataDir}{Prof.~Philippe Olivier Alexandre Navaux}
% \renewcommand{\nominataDirname}{Diretor do Instituto de Inform{\'a}tica}
% \renewcommand{\nominataCoord}{Prof.~Carlos Alberto Heuser}
% \renewcommand{\nominataCoordname}{Coordenador do PPGC}
% \renewcommand{\nominataBibchefe}{Beatriz Regina Bastos Haro}
% \renewcommand{\nominataBibchefename}{Bibliotec{\'a}ria-chefe do Instituto de Inform{\'a}tica}
% \renewcommand{\nominataChefeINA}{Prof.~Jos{\'e} Valdeni de Lima}
% \renewcommand{\nominataChefeINAname}{Chefe do \deptINA}
% \renewcommand{\nominataChefeINT}{Prof.~Leila Ribeiro}
% \renewcommand{\nominataChefeINTname}{Chefe do \deptINT}


%\renewcommand{\ALG@name}{Algoritmo}


% A seguir são apresentados comandos específicos para alguns
% tipos de documentos.

% Relatório de Pesquisa [rp]:
% \rp{123}             % numero do rp
% \financ{CNPq, CAPES} % orgaos financiadores

% Trabalho Individual [ti]:
% \ti{123}     % numero do TI
% \ti[II]{456} % no caso de ser o segundo TI

% Trabalho de Conclusão [tc]:
% além de definir explicitamente o nome do curso (\course) e o local
% de realização (\location), é necessário redefinir a nominata,
% pois as informações necessárias dependem do curso. Ex.:
%\renewcommand{\nominata}{
%        UNIVERSIDADE FEDERAL DO RIO GRANDE DO SUL\\
%        Reitora: Prof\textsuperscript{a}.~Wrana Maria Panizzi\\
%        Pró-Reitor de Ensino: Prof.~José Carlos Ferraz Hennemann\\
%        Diretor do Instituto de Informática: Prof.~Philippe Olivier Alexandre Navaux\\
%        Coordenador do curso: Prof.~Seu Creysson\\
%        Bibliotecária-chefe do Instituto de Informática: Beatriz Regina Bastos Haro
%}

% Monografias de Especialização [espec]:
% \espec{Redes e Sistemas Distribuídos}      % nome do curso
% \coord[Profa.~Dra.]{Weber}{Taisy da Silva} % coordenador do curso
% \dept{INA}                                 % departamento relacionado

%
% palavras-chave
% iniciar todas com letras minúsculas, exceto no caso de abreviaturas
%
\keyword{jogos online maciçamente multijogador}
\keyword{MMOG}
\keyword{simulação interativa distribuída}

\hyphenation{ma-ci-ça-men-te}
%
% inicio do documento
%
\begin{document}

% folha de rosto
% às vezes é necessário redefinir algum comando logo antes de produzir
% a folha de rosto:
% \renewcommand{\coordname}{Coordenadora do Curso}
\maketitle

% dedicatoria
%\clearpage
%\begin{flushright}
%\mbox{}\vfill
%{\sffamily\itshape
%``Se eu enxerguei mais longe,\\
% foi porque me apoiei nos ombros de gigantes.''\\}--- \textsc{Sir~Isaac Newton}
%\end{flushright}
%
%% agradecimentos
%\chapter*{Agradecimentos}
%Agradeço a todos\ldots

% sumario
\tableofcontents

% lista de abreviaturas e siglas
% o parametro deve ser a abreviatura mais longa
%\begin{listofabbrv}{SPMD}
%		\item[CRN] Continuous Random Networks (Redes Aleatórias Contínuas)
%		\item[WWW] Wooten-Winer-Weaire
%		\item[DM] Dinâmica Molecular
%\end{listofabbrv}

% idem para a lista de símbolos
%\begin{listofsymbols}{$\alpha\beta\pi\omega$}
%       \item[$\sum{\frac{a}{b}}$] Somatório do produtório
%       \item[$\alpha\beta\pi\omega$] Fator de inconstância do resultado
%\end{listofsymbols}

% lista de figuras
%\listoffigures

% lista de tabelas
%\listoftables

% resumo na língua do documento

\begin{abstract}

This graduate school study plan proposes a support model for MMOGs (massively multiplayer online games) by using systems similar to those created for large-scale sharing of computing resources, such as peer-to-peer networks. Following this model, a system could be formed on a peer-to-peer network to act as a server for some MMOG. Then, a portion of the game's communication and processing load would then be delegated to each node of the server system -- more precisely, the game's virtual environment would be partitioned into regions, each of which managed by one or more server nodes. Such a system would be perceived by the players as a central to which they connect via a \emph{gateway}. Each player is then seamlessly redirected to the appropriate server node. However, for such server system to work as expected, some issues must be addressed, such as maintaining the game state consistend among the different game server nodes, so each player has the same vision; management and balancing of the load assigned to each server node; what to do when a node crashes or leaves the server system and, finally, how to broadcast and store the game state to the players in a distributed manner in a way such that its most recent state can be restored even in the presence of system failures.

\end{abstract}

\chapter{Introduction}

%\begin{figure}%
%\includegraphics[width=\columnwidth]{avatarsdistribution}%
%\caption{}%
%\label{}%
%\end{figure}

Massively multiplayer online games (MMOGs) are the core theme of this study plan. Usually a client-server infrastructure is used to support this kind of games. By following this plan, a distribution model will be proposed, reducing the maintenance cost of the game server. In the next sections, the context of multiplayer games in general and MMOGs will be presented.

\section{Multiplayer games}

% o que são
% breve histórico e exemplos
% requisitos computacionais (sem mtos detalhes)

In the past few decades, since the creation of the personal computer, computer games have enjoyed an evergrowing popularity. After the acess to the Internet became widely available to the general public, with increasingly fast and cheap domestic connections, multiplayer online games has become an important market. To illustrate this, a study from 2006 estimated that the online games market would grow from US\$ 3.4 billion in 2005 to US\$ 13 billion in 2011 \cite{intelligence2006online}. The main characteristic of the MMOGs is the large number of concurrent players interacting with one another through the Internet. This kind of game may be divided into several categories, such as:

\begin{itemize}

\item FPS: \emph{first-person shooting}, in which each player controls a character who has one or more weapons, with which he fights enemies that, in turn, may be controlled by other players or by artificial intelligence. These games are characterized by fast action, including shooting, moving, dodging etc.;

\item RTS: \emph{real-time strategy}, where each player commands an army, similarly to a chess game, except that the game play is not divided in turns, i.e. it's a real-time game and the player who thinks faster than the other may have an advantage. Nevertheless, the action is usually slower than in a FPS game;

\item RPG: \emph{role-playing game}. In this kind of games, each player has a characters who evolves with time, acquiring power and accumulating wealth. These games are characterized by not having a predetermined end of the ``match'', creating a virtual world with persistent state. The player may, then, connect to this world, play for some time with his character, disconnect and, later, reconnect and continue from the point he was when he disconnected for the last time, for his state is stored in the game server.

\end{itemize}

As examples of well-known online multiplayer games, we may cite \emph{Quake} \cite{quake} as a classic FPS game; \emph{Starcraft: Brood War} \cite{broodwar} a classic RTS game still played nowadays and Diablo II \cite{diablo2} as an RPG example.




\section{Massively multiplayer online games (MMOGs)}
%TODO: por um monte de referências a MMOGs, do tipo (de maior sucesso são X, Y, Z), outros exemplos são A, B, C
% requisitos computacionais elevados a 1000

After single-player computer games evolved to multiplayer online games with the advent of the Internet, MMOGs emerged as a new trend because of the decrease of the domestic Internet connection cost and the increase of its average bandwidth. These kind of games have become very popular in the latest years because they can not only be played online, as they also allow the interaction of a massive number of players at the same time. In the most succesful cases, such as World of Warcraft \cite{worldofwarcraft}, Lineage II \cite{lineage2} and EVE Online \cite{eveonline}, for example, tens of thousands of players are supported simultaneously \cite{chen2006pch}. These players can, then, interact with one another and with the virtual environment of the game.

One of the main features of these games, present in almost all commercial MMOGs, is that the matches are very long. In some MMORTS (real-time strategy MMOGs), such as Travian \cite{travian}, the games come to last from six months to one year. MMORPGs (MMOGs in RPG style), as is the case of World of Warcraft, the games has no given time to end. The worlds of these games are so vast and populous -- as regards the number of players -- that they may evolve and modify their state independently of some players being playing it or not, because there is always someone connected so the games never stops. For this reason, it is expected that each player can disconnect and continue playing later, without having to start from scratch. Moreover, it is expected that changes made on the game world persist, no matter how many times each player enters and leaves.

Generally, each player controls an entity called \emph{avatar}, which is nothing more than his representation in the virtual environment -- a character who executes the orders given by the player, therefore interfering in the history and in the outcome of the game. For the game to remain consistent for the different participants, each action performed by each avatar must be processed by the server, which calculates the game state resulting from such action. This new state is then broadcast to other players. Other changes in the game world, such as destruction or creation of objects in the environment, and events such as actions of characters controlled by the server must also be sent to the players involved. It is then through these messages sent by the player to the server and in the opposite direction that that players can interact with each other and with the simulated world of the game.

However, it is perceived that such a mechanism can easily saturate the bandwidth and overload the cpu(s) of the server. What is usually done is build an infrastructure with a large central server, usually a cluster with its nodes connected through local high-speed and low latency network, with an Internet connection of some hundreds or thousands of MBps. The greatest cost comes from maintaining this connection, whose main purpose is to maintain every player as up-to-date as possible about the game state -- naturally, tolerating some delay, which should not be over a given threshold.

%Jogos dessa natureza têm alguns requisitos \cite{schiele2007rpp}, dentre os quais podem ser citados: \textbf{persistência} do estado do mundo virtual e dos avatares; \textbf{disponibilidade} do serviço; \textbf{consistência} do estado do mundo e dos avatares entre os diferentes participantes; \textbf{resistência a trapaça}, no que se refere a tentativas de subversão das regras do jogo por jogadores desonestos e \textbf{escalabilidade}, tendo em vista que o grande número de jogadores poderá facilmente sobrecarregar a infra-estrutura de suporte se esta não tiver capacidade de processamento e, principalmente, largura de banda suficientes.




\chapter{Motivation and state of the art}

%O que é comum a qualquer um dos gêneros de jogos online multijogador é o fato de serem simulações interativas de tempo-real. São simulações no sentido de que simulam um mundo tão parecido quanto possível com o mundo real -- embora alguns jogos se distanciem propositalmente do realismo. A interatividade vem do fato de que há vários participantes executando ações que modificarão o andamento do jogo. Por fim, são de tempo-real porque diversas ações executadas por um jogador devem ter efeito imediato, sob pena de prejudicar alguém. Em um jogo FPS, por exemplo, espera-se que após um jogador enviar o comando de puxar o gatilho, arma de seu personagem dispare o mais rápido possível. Além disso, é necessário manter a consistência da simulação entre os jogadores, para que estes visualizem o jogo no mesmo estado.

%Para jogos online multijogador de pequena escala (com, no máximo, algumas dezenas de participantes), costuma ser suficiente montar uma rede cliente-servidor, onde o servidor é o computador de um dos próprios jogadores, que a ele conectam-se através de um software cliente. Esse servidor atua como árbitro, de forma a manter o estado do jogo consistente entre os diferenetes participantes. Outra abordagem é formar uma pequena rede par-a-par entre os jogadores, utilizando algum algoritmo para manter a consistência da simulação, que agora é distribuída.

As mentioned in the previous section, MMOGs are characterized by a large number of players. To support this great number of participants, a client-server infrastructure is generally used, and all interaction is done through the server machine. In this paradigm, the server computer has the official copy of the game state and it is responsible for computing its change over time, while the game client is responsible for presenting to the user the game state sent by the server. The server is also responsible for updating the clients, in real time, on the changes that occur in the virtual environment of the game. Because of the high number of participants, the centralization on the game server makes the maintanance cost very high. Generally, it is required a connection to the Internet with several GBps of bandwidth and enough processing power to run the simulation of the virtual world \cite{feng2007wnn}. It becomes impossible, for example, the maintenance of massively multiplayer online games by small or independent groups on a limited budget.

Because of this high cost, alternative solutions have been sought in order to distribute somehow the communication and processing loads originated from the game. Generally, it is proposed the use of peer-to-peer networks -- or even computer GRIDS \cite{butterfly, wang2004gem}. However, an MMOG is a simulation of a dynamic virtual environment, with a maximum tolerable delay between sending the player's actions and receiving the resulting state. MMOGs have also other requirements that must be observed carefully so that the players may have a good game experience. To distribute the network support structure among different machines connected via the Internet -- which is the case of the peer-to-peer networks -- while meeting the requirements of an MMOG becomes a challenging task that has motivated many researchers in recent years.

In the following sections, we introduce some requirements of the MMOGs in addition to the state of the art as regards the distribution of the infrastructure to support this kind of game. Finally, it will be presented some research questions that are still open, and which can be addressed in a doctoral project.


\section{Requirements of the MMOGs}

Based on the current state of the art and in previous work -- such as in \cite{bezerra2009lbs, bezerra2008a3, vilanova2008psm, cecin2006pps, cecin2004fsa} --, we can summarize a few requirements that we consider critical for the game network support infrastructure to be considered adequate, and which will be dealt with in the doctoral course:

\begin{itemize}

	\item \textbf{Persistence} - MMOG games generally consist of a virtual world where players interact with each other and with the environment, changing the state of the world and of their own avatars. It is expected that each player can leave the game and return some time later without these changes having been undone. For this reason, it is necessary to support the persistence of the states of each avatar and of the virtual world as a whole;
		
	\item \textbf{Availability} - In general, MMOG games are not free and, because of that, their users tend to be demanding when it comes to availability. Thus, it is desired the system is always available;
	
	\item \textbf{Consistency} - Multiplayer Games consist of a virtual environment shared among the players participating in the same game. It is therefore necessary that the environment is represented in the same way on the machines of the various players so that they can interact with each other and with the world in an appropriate manner;
	
	\item \textbf{Security} - In a system where there are tens of thousands of participants, it is unreasonable to rely on all of them, requiring some technique to provide resistance against faulty or malicious behaviour. Security here refers not only to the authentication of registered users, but also to check whether the states or actions that the different players submit are valid. Cheaters, for example, can change the software running on their machines so it may send states or actions that give them an advantage in the game;
	
	\item \textbf{Scalability} - Taking into account the number of participants in an MMOG game, it is necessary that the system that supports it is able to maintain the quality of service despite the increasing burden of processing and communication required for this.

\end{itemize}




\section{Related work}

The \textbf{client-server architecture} meets various aspects necessary for the satisfactory implementation of games such as MMOGs, what includes a high level of control over the system as a whole, which facilitates authentication, persistence and security. But the maintenance of a traditional MMOG server is expensive, as already mentioned, besides having the server as a possible bottleneck. In order to minimize this problem some alternatives have been proposed. One of them is to use cluster computing, where a cluster, rather than a single computer, plays the role of the server. This approach has a significant increase in processing power, but does not solve all the problems of massively multiplayer online games. It should also provide the bandwidth needed to support the traffic between the server and the players.


%TODO: citar o paper sigcomm 2007 que mostra os "Challenges in peer-to-peer gaming"

Another approach is the \textbf{peer-to-peer architecture}, where the simulation is divided among the computers involved. There can be a system without any server, where the peers, which are the machines of the players, come into some kind of agreement for the various steps of the simulation. Regarding scalability, this approach is not optimal, since ensuring such "agreement"{} is costly in terms of message exchange \cite{lamport1982bgp}. Even if one of the peers is elected to decide the course of the simulation, still persists the problem of all peers needing to exchange messages with one another. Having $n$ peers, there is a complexity of O({$n^2$}) message exchanges for each step of the simulation. Clearly, this approach is not as scalable as should be a system to support a massively multiplayer online game. Moreover, it would be necessary to distribute the storage and retrieval of the states of the game.

Some studies -- such as \cite{schiele2007rpp, rieche2007ppb, hampel2006ppa, elrhalibi2005abm, iimura2004zfg, knutsson2004pps} -- have been done to make games on peer-to-peer networks more scalable, . For example, to reduce traffic between the peers, each peer can send state updates only to whom the state changes are relevant. To achieve this goal, \cite{schiele2007rpp} suggests the division of the virtual environment into regions. The purpose of this is for each region to act as an independent set of smaller scale. Players whose avatars were in a given region could form a small peer-to-peer group and their own computers would decide the outcome of the players' actions in that area of the virtual environment. When an avatar moved from one region to another, it would leave the first group and join the group of its new region. Since the environment is considered contiguous, i.e. the avatars could move freely across adjacent regions, some of the peers in a group would keep connections to peers from groups of neighboring regions and, through these connection between adjacent groups, the necessary information for transfering a player could be obtained.


%TODO: por mais refs aqui após o ", como"
According to the work of \cite{schiele2007rpp}, each region has a coordinator. The coordinator is elected among the peers which were present and becomes responsible, only, to decide to whom each state update is relevant -- it does \emph{not} intermediate message exchanges between peers, whose communication is direct. However, this approach is based on the fact that the coordinator is reliable, which can not be guaranteed, since the software used by the player may have been modified to behave incorrectly in order to provide invalid benefits -- what is also known as \emph{cheating}. Another approach would be to elect multiple coordinators per region, but that would involve implementation of a voting mechanism, and depend on the availability of a certain number of peers to manage the region. Moreover, the communication load remains quadratic (in the worst case), since every peer must send its state to several other peers.

There are also proposals for \textbf{hybrid architectures} \cite{vilanova2008psm, chen2006pch}, using servers and peer-to-peer networks at the same time. According to these works, peers and server share the simulation of the game world. In \cite{vilanova2008psm}, the game world is divided into social space and action spaces. The first is aimed at social interactions, such as chat, exchange of in-game items, forming groups, etc., which are actions that do not impose a heavy burden on the server. However, if the players want, for example, fight -- what is the main objective in most MMOG games -- they have to request to the server to create an action space within which the interaction is faster and with little tolerance for communication delays. This space is an \emph{instance} of the game, isolated from the rest of the world, within which a limited number of players form a small peer-to-peer group, being themselves responsible for simulating the game and for updating his companions on the state of the game. To resolve inconsistencies in the simulation due to lack of message ordering, one player is chosen as a \emph{super-peer} and is responsible for ordering the events that are "heavily coupled", whose order can significantly interfere in the outcome of the game. This approach presents some problems, such as the fact that there cannot be a fight, for example, between a large number of players. Moreover, nothing guarantees that the peer chosen to be the super-peer is trustable. If it belongs to a dishonest player, it may order the events in an order such that its player is benefited. In addition, the problem of overloading the bandwidth of peers is addressed by simply setting a limit to the number of participants in each action group, when in fact it is desirable that in an MMOGs there is a lot of players interacting with each other, not only in social circumstances, but also in more dynamic situations, like fast-paced fights.

In \cite{chen2006pch}, the virtual environment is divided into regions, each managed by a peer, which acts as a sub-server. Each one of the other participants in the region sends state updates to this sub-server, which forwards the messages to the other peers in the region to which the state changes may be relevant. To provide fault tolerance, the authors suggest the use of peer clusters, consisting of the region's sub-server and backup peers. These backup peers receive the players' actions from the region manager and process them, creating a backup of the game state. In addition to providing robustness to the system in case the manager crashes, these backup nodes may also detect faults in the simulation and perform recovery procedures. However, this approach does not solve the problem of the peer elected to be the region manager not being reliable: to prevent the backup nodes from detecting an invalid simulation, the region manager may send invalid actions to them, instead of forwarding the players' real actions. Finally, if a region manager gets overloaded, it simply returns to the server part of the load assigned to it, keeping a dependency on a centralized infrastructure.

Another hybrid architecture is that of FreeMMG \cite{cecin2004fsa}. In it, the players are organized in a peer-to-peer manner in every region of the virtual environment and the server mediates the communication between different regions. Again, there is the problem of security: as the peers within a region control the simulation that occurs  there, they can also subvert it. The author proposes a probabilistic approach, using a randomly selected peer to verify the simulation in that region. It is expected that, if the peers in a given region try to subvert the game there, at least the randomly inserted node detect the invalid actions and report to the server. However, besides not completely guaranteeing security, the problem persists there may be many peers communicating with many, which may compromise the quality of the game.

Some models that suggest the use of clients connected to a distributed server have been proposed in the literature. In \cite{assiotis2006dam}, for example, it is proposed to divide the virtual world into smaller regions, each assigned to a different node of the server system. The authors address the consistency problem by using a lock mechanism -- each entity in the game is associated with a lock that must be obtained before any of the servers making any changes. In addition, they tried to address the problem of \emph{hotspots} (clusters of players in a relatively small area of the virtual environment) through the recursive partitioning of the overpopulated area until the overload is eliminated or there are no more servers available. However, there is a practical limit to this partitioning, for very small areas cause avatars to migrate between regions more often, which implies more network traffic between servers.

Finally, the authors of \cite{assiotis2006dam}, as well as several others with similar proposals \cite{ng2002msa, chertov:olb, lee2003sdl}, consider that the nodes are servers connected through a high speed and low latency network, what make their solutions only partially applicable in a scenario with highly dynamic and volatile resources, such as the peer-to-peer networks formed with volunteer resources. Such networks have some inherent problems: nodes with low availability and dependability, low bandwidth and low processing power compared to current dedicated MMOG servers maintained by MMOG developers.


\section{Research questions}
\label{researchquestions}

In a completely decentralized MMOG deployed on a peer-to-peer network, each peer is responsible for deciding the outcome of the actions of its player. Although this makes the system less dependent on a single point of failure -- if a player is disconnected from the game, only the state regarding its avatar will be lost -- and to make the game independent of central servers, this approach proved to be very vulnerable to cheating precisely because at least part of the simulation is relied on the peers. Besides, this approach is prone to saturation of the upload bandwidth of the participants, who must send state updates to their fellow players.

The aim is to investigate the use of a server system consisting of geographically distributed volunteer nodes. This system would be heterogeneous, where each node could be anything from a home computer to a cluster belonging to some company that had interest in serving the game. Some minimum processing power and communication bandwidth would be required for being part of the server, and it would be necessary to ensure somehow that each node is trusted. However, taking into account that the number of server nodes would be much smaller than the number players, it would be more feasible to ensure its reliability regarding the possibility of cheating than in a fully decentralized peer-to-peer architecture. Furthermore, the server nodes do not necessarily belong to players. They could be small local Internet service providers (ISPs), for example, who would profit by putting their resources available for a game. That would be interesting to these companies for the resources -- at least communication bandwidth -- of the ISP would be used anyway, for all the traffic from players who were also its subscribers would pass over there regardless of which server each player was connected to.

Nevertheless, as the simulation would be distributed among the server nodes, it is not necessary that all they have the same processing power or communication bandwidth owned by the huge central servers commonly used for MMOG games. To make this distribution, the game world could be divided into regions, each managed by at least one of these server nodes. More than one server node should be assigned to each region, so that the simulation would be distributed on two levels: first into regions, then within each one of them among the nodes managing it. Thus, each player would send his actions to one of these nodes, which would process them, then synchronize with other nodes in the same region and, finally, make the resulting game state persistent in a distributed way and send it to the players to whom it is relevant. Thus, it would also be provided a better availability, as each region of the virtual world would be served by a set of servers holding a synchronized game state. If any of these servers fail, one of the others could take on the players who were connected to the server that is no longer available.

To achieve the goal of distributing an MMOG server on a dynamic network, with few and volatile resources and less dependability, as are the peer-to-peer networks formed by volunteer nodes, some questions that either have been the subject of research in recent years or that are still unresolved arise. Some of them are:

\begin{itemize}

\item Assign to each server node a portion of the virtual world, so that the load is dynamically balanced, taking into account the existence of \emph{hotspots} (clusters of avatars in a relatively small area);

\item Maintain the simulation consistent among the different regions and among servers managing the same region;

\item Coordinate the entry, exit and the crash detection of nodes of the system, providing fault tolerance;

\item Distribute and store in a persistent manner the state of the world and of the players, so that they can be retrieved when necessary;

\item Optimize the communication between clients and servers in order to save the maximum possible bandwidth, without this being perceptible by the players.

\end{itemize}

It is intended, during graduate school, research and develop new solutions to these problems, seeking those that are most appropriate in a context of massively multiplayer online games. With these issues resolved, it may be provided to MMOGs availability and fault tolerance -- due to the replication of server nodes in the same region -- and scalability, while maintaining the communication delay within an acceptable range for the game and the a lower financial cost, compared to traditional MMOG servers.

%\begin{figure}
% \centering
% \includegraphics[width=0.50\textwidth]{imagens/www}
% \caption{Troca de ligações no algoritmo WWW. Esquerda: configuração inicial; Direita: configuração após a troca}
% \label{fig:WWW}
%\end{figure}
%\begin{equation}
%	\label{equ:Hib}
%	 Hib=\frac{1}{N}\sum_{i=1}^NC_i(N_i-N_{0_i})^2 
%\end{equation}

%\begin{equation}
%	\label{equ:Ene}
%	 Energ=\sum_{r_{ij}<r_{max}}[k_r(r_{ij}-r_{0_{ij}})^2+\sum_{r_{ik}<r_{max}}K_a(\theta_{ijk}-\theta_{0_i})^2] 
%\end{equation}

%explicar onde o CoSMMuS se encaixa na literatura: o que que vai contribuir?
%enfiar tantas referências quanto for possível, porém evitando dizer que já existe algo pronto

\chapter{Objective}
	
The main objective of this doctoral plan is to create a decentralized architectural model to support massively multiplayer online games. Following this model, it should be possible to form a system of geographically distributed server nodes, using the Internet as a means of connection between them. This distribution should be transparent to the players, to whom the system will be seen as a single MMOG server, which maintains the game world consistent, available and with a good quality of service.

%Além de distribuir as cargas computacionais (comunicação e processamento) impostas pelo grande número de pessoas jogando, este modelo deverá incluir técnicas com o fim de reduzir o tráfego entre os componentes deste sistema (nodos servidores e máquinas clientes dos jogadores), economizando largura de banda. Tais técnicas são o foco deste trabalho, tendo em vista que se considera um cenário com recursos voláteis e limitados, já que a ligação entre os nodos será feita através da Internet.

%Existem outros aspectos relevantes, além da distribuição do servidor e da economia de largura de banda, que poderão ser acrescentados ao modelo, dependo da disponibilidade de tempo para realizar tal tarefa.

\section{Detailed objectives}
%TODO: por aqui as referências de gerenciamento de interesse e de topologia, difusao etc. (ver slide "em andamento" da semac)

%A função deste middleware será de abstrair para a camada do jogo, que ficará acima dele, o sistema geograficamente distribuído servidor. distribuir as cargas de processamento e comunicação entre 
%
%sistema distribuído sobre a Internet, que funcionará como um grande servidor para jogos online maciçamente multijogador. Pode ser utilizado o conceito de "super-nodo", que nada mais é que um computador conectado à Internet, com capacidade de processamento e comunicação acima da média de usuários comuns, mas que, ainda assim, é bem mais limitado que os grandes servidores que costumam servir os jogos MMOG mais conhecidos. A idéia é que diversos destes super-nodos, conectados à Internet, formem um sistema distribuído que aceitará e repartirá conexões oriundas de jogadores. Eles então dividirão a carga de processamento e de comunicação dos diferentes jogadores conectados, assim como a simulação do ambiente virtual do jogo.

To achieve this general objective, some goals were established:

\begin{enumerate}

%TODO: mecanismo -> outra palavra
%TODO: dividir este item em 2: distribuiçao e rede overlay parecida com a real.
\item Develop a mechanism to deal with entry, exit and crash of server nodes, providing fault tolerance, while trying to keep the nodes which are geographically close to each other adjacent in the overlay network of the server system;

%TODO: dividir este item em 2
\item Create an algorithm for balancing the load of the game, maintaining the load on each server proportional to its capacity, while avoiding the splitting of a hotspot into different regions, as this would cause a strong dependence between these regions \cite{bezerra2009lbs};

\item Define a scheme for synchronizing the simulation state among different server nodes assigned to the same region of the gaming world, as well as synchronize periodically, or when necessary, the states in different regions, in order to maintain global consistency;

\item Build a distributed persistence mechanism to store the states of the players and of the virtual game world as a whole, so they are always available for any server node, even if some of these become unexpectedly unavailable;

\item Design techniques and algorithms that aim to reduce intra-server and server-client communication, in order to save resources of the server nodes, reduce delays in the communication between them and expand the audience of the game due to the reduction in the bandwidth required to play it and, besides, reducing the requirements for a computer to be part of the server system, without undermining the game experience of the players.

%\item Analisar a aplicabilidade destas técnicas em cenários em que cada nodo do sistema tem recursos mais limitados;
%
%\item Propor integração das mesmas, com otimizações focadas no contexto definido (disponibilidade de super-nodos, ao invés de servidores poderosos);
%
%\item Implementar um protótipo que integre as técnicas estudadas e/ou desenvolvidas no trabalho;
%
%\item Efetuar simulações que demonstrem o resultado obtido do trabalho e avaliar seus resultados.

\end{enumerate}


\chapter{Preliminary model: Cosmmus}
% as refs vão aqui
% divisão em regiões
% distribuição em dois níveis -> porque usar mais de um servidor seria melhor do que um só (menor tráfego entre eles e processamento distribuído)
% Cooperatie System for Massive Multiplayer Service
% duong ta
% citar o fábio e o modelo de sincronização que ele usa (simulador otimista e conservador)
% falar algo de pastry, chord etc., para persistência distribuída
% falar do modelo "filosófico" anti-trapaça (falar das duas opções: provider-centric e anarchy-centric)
% Como os jogadores interagem!!!
% otimização do uso de largura de banda com IM (citar dewan, eu, etc.)

In a previous work \cite{bezerra2009lre}, it was set up a preliminary model -- which aimed to partition the virtual environment into regions, each assigned to a single server -- on which a load balancing scheme was defined. The Cosmmus -- Cooperative System for Massive Multiplayer Service -- is a new model to be defined during the doctorate course, which will also uses the principle of partitioning the virtual environment of the game into regions, but addressing the most critical problems (as referred in section \ref{researchquestions}), which were left out so far.

Cosmmus should include solutions to the major aspects of MMOGs, such as task distribution, synchronization of the simulation, distributed persistence and so on. Although this model is not defined yet, there are already some ideas on how it could be and what kind of approach it should use, based on related research. In the following sections it will be presented these initial ideas, which will be better developed during the doctoral course.
% Como os jogadores interagem!!!

\section{Load distribution}

Some studies have been done concerning the partitioning of the virtual environment of the game, as \cite{devleeschauwer2005dma, morillo2006spp, lui2002epa}. For Cosmmus, it is intended to make the load distribution among the game servers in two levels:

\begin{enumerate}
	\item It will be used the idea of regions (portions of the virtual world), whose size will be adjusted dynamically depending on how the avatars of the players are more or less concentrated in certain places. This should be done transparently to the player, who will see a large contiguous world through which he can move freely;

	\item Each region can be assigned to more than one server node, with two main objectives: first, to provide fault tolerance through replication and, secondly, to allow regions that are already heavily used to be managed by more than one server node.
\end{enumerate}

If a region get heavily crowded, one could think about splitting it in two or more new regions, but this could be counterproductive in certain situations, as in the case of a region that contains a hotspot: its division would result in two regions overly dependent on one another. Because of this kind of situation, it should be also created an algorithm, heuristic or metric to determine whether a region should or should not be subdivided into new regions.

It has been proposed, during the master course, a dynamic load balancing scheme based on graph partitioning and refinement of its partitions \cite{kernighan1970ehp, karypis1999pmk, karypis1998mam, dutt1993nfk}. The world was divided into cells of equal size and fixed position, each represented by a vertex in the graph. The interaction (measured in kilobytes per second) between the cells are represented by the edges of the vertices. The algorithm consists of partitioning the graph, where each partition represents a region to be assigned to a server. This balance takes into account different levels of resources among different servers and takes into account the needs of MMOGs, considering the bandwidth usage as the load to be balanced among the server nodes.

It will also be created a novel load balancing scheme which is intended to follow a few principles of the scheme proposed in the master's thesis. However, unlike the model suggested previously, there will be not only one server node per region, but a group of server nodes. In this case, it will be investigated ways to balance the load of the system, considering the distribution in two levels. Besides, other environment partitioning techniques could be used instead of using cell grids, such as space partitioning trees, as hinted in \cite{bezerra2009fgl}.

\section{Formation of the server system overlay network}

Regarding the formation of the overlay network on which the server system will be deployed, there are some proposals, such as in \cite{ta2008nas, ratnasamy2002tao, han2005tao, zhang2004cla}, which try to build a network so that nodes with good network connection between them are adjacent in the overlay topology. It was proposed, for example, grouping the nodes according to the network delay between them. The goal is to use these techniques so that certain server nodes -- nodes which are serving adjacent regions and, especially, serving the same region -- belong to the same group. Adaptations are possible, including criteria other than delay, as the data transmission rate between them, in bits per second.

The purpose of mounting the overlay network following this strategy would be to minimize the delay in interaction between players. This delay in the interaction would be the time elapsed since the sending of an action from a player, processing by the server and receiving the resulting state by another player. If any two players are interacting with each other, but each one of them connected to a different server node, it will be required that each of their interactions is mediated by both servers. So, if the connection between these two servers has a low delay, the interaction of the players will be less harmed by the addition of a second intermediary.

\section{State synchronization}

One of the key issues that will be handled by Cosmmus is maintaining the consistency of the simulation among the different server nodes. Even if each player sees just a part of the virtual world, this world must be the same for all servers. Thus, if two players are with their avatars in the same place of the virtual environment, they should see the same scene. Another important issue is the ordering of events. Assuming that two players are fighting in the game, the avatar of one of them shoots with a gun and the other avatar moves, the order of these events would be crucial to decide whether the latter player had his avatar dead, only wounded or completely avoided the bullet.

In the event that both players are connected to the same server, as it is traditionally done by game developing companies, this task would be trivial, by simply checking which actions come first. Even if a mechanism for delay compensation -- the \emph{timestamp} of the action of each player would be equal to the current time minus the player's connection latency -- as it is done in Half-Life \cite{halflife}, for example, it would not be too problematic to sort these events. In the case of a distributed server, it would require the server nodes to enter into some kind of agreement or synchronization regarding this event ordering, whose complexity would grow with the increase of the number of servers involved.

Taking into consideration that there are several regions forming a contiguous world, and that in each one of them there is one or more servers, these issues to maintain the consistency of the simulation becomes even more difficult. It is expected that the division of the environment is seamless to the player. Then, when approaching a region boundary, the player should be able to see whatever is beyond it and to move freely across the border. For this, it will be necessary that the server to which he is connected to communicate with the one that serves the region beyond the border which is being viewed by the player. It will provide information such as the state of the environment and of avatars who are nearby and of other objects in the game.

In \cite{cecin2006pps}, it was proposed a state synchronization scheme that consists of two simulators: one conservative and one optimistic. The optimistic one processes each player action immediately after it is received and its resulting state becomes available to the player and something is show on his screen. The conservative simulator, however, divides the time in turns and only performs the actions of the players after performing a synchronization. At each turn, it waits for the arrival of the actions of all players involved -- or some explicit notification that they did nothing -- which ared then sorted and processed. Only after this step the conservative simulator advances to the next turn. In the case of the optimistic simulation deviate beyond a tolerable limit from the conservative one, the latter overwrites its state on the first, which continues from there. However, this scheme was proposed for a fully decentralized architecture, being necessary to analyze it and make necessary adjustments so it can be used in a server system distributed in two levels, as intended for Cosmmus. There are also other works that aim to maintain a consistent simulation, such as \cite{zhou2007cmh, moon2006emc, muller2006csm}, which will also be studied and possibly some of its principles will be part of the solution for consistency designed for the final model.

\section{Distributed persistence}

Regarding the storage of the state of the virtual world and the players, it will be devised a way to do this in a distributed manner, since there will not be an unique central server. It might be simpler to choose one of the server nodes to save this information. However, this could cause the game state to depended on the availability and reliability of the chosen node and, even if these two conditions were satisfied, the node's connection could be easily saturated by the great number of requests, slowing down the recovery of the states stored in it.

Cosmmus should then use a distributed storage scheme, where portions of the state information are stored in different places. Furthermore, it should replication, so that the state becomes available even if some nodes of the system disconnect or crash unexpectedly. DHT-based overlay networks, such as Pastry \cite{rowstron2001psd}, Tapestry \cite{zhao2004trg}, Chord \cite{stoica2001csp} and Koord \cite{kaashoek2003ksd} seem to be possible solutions to provide the kind of distributed and redundant storage desired. It is intended, therefore, to investigate how suitable these networks really are for this purpose. There are simulators, such as OverSim \cite{baumgart2007ofo}, allowing the simulation of overlay networks, such as those mentioned, and through simulation it be will assessed the behavior of the system when using some of these logical networks.

A problem, however, is that the computational cost of using those DHT-based networks may become too high, for it would be necessary to maintain the structure of a network such as Pastry on the server system, retrieving and storing the game state with application level multicast and replication, added to the own cost that the server nodes handle to perform the game world simulation itself, receiving players' actions and returning them a resulting state. To avoid overloading the system with traffic related only to persistence of the game state, some parameters could be adjusted, like the state update frequency and, at the application level, the level of detail of the state to be persisted. For example, instead of storing the location, direction and action being performed by each avatar in an area of the virtual environment, it could be stored only its location.

\section{Bandwidth usage optimization}

As the server nodes are, ideally, of low cost, it is necessary to save their resources as much as possible, but without harming the game quality. For example, it can be made some interest-based filtering, being sent to each player only what he can see, in order to save as much bandwidth between clients and servers, and between the servers. Following this same principle, servers from two different regions may have an old version of the state of each other, if there is no interaction between players whose avatars are in different regions. Thus, these servers do not need to update each other so often.

Periodically, or when it is needed (e.g. two players from different regions interacting near the border), the states of the regions may be exchanged between the servers managing them. The granularity of this information can be even thinner, and each server could send to the other only the most essential data. For example, each server would send to the other only the state of the virtual environment near the border between the regions, rather than the state of the entire region.

Several works have been made in order to make filtering interest-based message filtering \cite{bezerra2008a3, ahmed2008dai, morgan2005imm, minson2005aim}. In addition to studying which one best fits the proposed model, and evaluate the possible adjustments that are necessary, other ways to save the resources of the server system will be investigated.


%TODO: mudar esse título de seção
\section{Philosophical questions}

%A filosofia por trás do Cosmmus está na cooperação entre diversas pessoas e/ou instituições com o intuito de formar um sistema para servir um jogo online maciçamente multijogador, disponibilizando seus recursos para isso.
	
Although generally it is needed a powerful, centralized and expensive \cite{feng2007wnn} infrastructure to support an MMOG, a system that follows the approach outlined here would allow the resources of smaller businesses and home users (with the required minimum of processing power and connection bandwidth, which will depend on the particular game) to be used in order to form a system to serve a massively multiplayer online game with quality comparable to the most popular MMOGs.

The fundamental idea behind Cosmmus is to form a server system on a peer-to-peer network, rather than indiscriminately distributing the simulation among all players, as are several proposals surveyed. With such separation, where only the server nodes could decide the progress of the game, it could be formed communities whose sole purpose would be to keep MMOGs up and running, organizing who would be allowed to participate in the system as a server node, with which permissions, and so on. There could be a scheme similar to that used in various free software projects, in Wikipedia \cite{adler2007cdr} and others, where the individual -- or company -- who had the initial idea gradually delegates authority to community members, according to how much each one cooperated, creating a hierarchy, with different levels of permission, but with all participating in a common effort.

In addition to this philosophical question, to an MMOG server, which acts as referee and where the actual simulation is performed, it is easier to detect and prevent cheating than in an MMOG with a completely decentralized simulation, where each player's computer decides in part what will happen as a result of players' actions in the game. However, even in a collaborative network as the one idealized in this study plan, there is no guarantee that some of the members will not try to subvert the rules of the game, providing unfair advantages to some players, or even just destroying part of the game state. However, a reputation system is imagined. When entering the server system, each participant will have a record, stored in a trusted location, of how he has performed the simulation of the game.

This reputation system would work as follows: at first, it would be assigned to the new server a portion of the world which is considered of minimal importance, so that attempts to subvert that part of the game environment will cause very little damage to the game, if any. Both players and servers may report such cases in order to punish or even banish the node that acted maliciously. Honest members of the server system will gain reputation points with time, and they will manage increasingly important portions of the game world. It is believed to be enough demotivating the idea of destroying a good reputation, gained after a long period of honest collaboration with the game because of an cheating attempt.

This way, many MMOGs could arise and become popular more easily, opening this market to small companies and independent game developers. Every game would be associated with a self-regulating community. The level of justice or tampering of each one of them would depend on who were responsible. A well organized community could make a game as fair as those managed by large companies with expensive and powerful central servers, for example.

% reputação crescente para servidores, mecanismos de "manteneção", wikipédia sw livre etc.
% comunidades livres X provedores

\chapter{Plano de trabalho}

Este capítulo do plano de curso de doutorado tem como propósito detalhar os passos que vão se seguir para atingir os objetivos definidos anteriormente, desde a metodologia pretendida até o cronograma e planejamento dos créditos.

\section{Metodologia}
\label{sec:metodologia}

Para atingir o objetivo definido na seção anterior, deverão ser cumpridas algumas etapas, que são as seguintes:

\begin{enumerate}

\item \textbf{Exigências do doutorado}: requisitos impostos pelo programa de pós-graduação em computação da UFRGS ao estudante de doutorado;

\begin{enumerate}
\item Revalidação dos 24 créditos cursados durante o mestrado;
\item Cumprimento dos créditos restantes exigidos para o doutorado;
\item Realização de atividade didática referente ao estágio-docência;
\item Apresentação de seminário de andamento na Semana Acadêmica do PPGC;
\item Realização do exame de qualificação em abrangência;
\item Apresentação da proposta de tese;
\end{enumerate}

\item \textbf{Revisão bibliográfica}: tem por objetivo expandir o domínio sobre o estado da arte relacionado à distribuição de jogos MMOG;
%TODO: por em emph palavras estrangeiras ao longo do plano, mas so na primeira aparição do termo
\begin{enumerate}
\item Estudo de tecnologias de formação de redes overlay e verificar sua compatibilidade com o tipo de gerenciamento de entrada, saída e colapso de nodos servidores pretendido;
\item Pesquisa de artigos que propõem técnicas visando a colocar os servidores distribuídos na rede overlay, levando em consideração a qualidade da comunicação entre eles (i.e. servidores próximos geograficamente tenderão a ser adjacentes na rede overlay);
\item Análise de algoritmos de balanceamento de carga, no que se refere à sua aplicabilidade em um servidor distribuído de MMOGs, de maneira a determinar o que se precisaria modificar para adaptar ao contexto de jogos;
\item Pesquisa de trabalhos que têm por objetivo a descoberta e gerenciamento de hotspots, de forma que sua existência não degrade a qualidade de serviço do jogo;
\item Revisão de técnicas para sincronizar o estado do jogo entre diferentes servidores de maneira dinâmica, sem que isso gere tráfego excessivo no sistema servidor;
\item Pesquisar mecanismos de persistência distribuída, consistente e tolerante a falhas que possam ser utilizados para armazenar os estados dos jogadores e do ambiente virtual;
\item Estudo sobre técnicas existentes para reduzir o tráfego entre os clientes e os servidores e entre os servidores, de maneira a reduzir custos sem prejudicar o jogo;
\end{enumerate} 

\item \textbf{Definição do modelo}: tem como objetivo definir os componentes necessários à arquitetura para que seja capaz de fornecer o tipo de serviço pretendido;

\begin{enumerate}
\item Definição do tipo de topologia que a rede overlay deverá ter e de qual tecnologia será utilizada/adaptada para o gerenciamento desta rede;
\item Definição dos critérios utilizados para efetuar balanceamento de carga e como isso será feito;
\item Definição do esquema de sincronização entre os nodos servidores;
\item Definição do modelo de persistência utilizado para armazenar de maneira distribuída e tolerante a falhas o estado dos mundo virtual e dos jogadores;
\item Integração do modelo definido com técnicas de otimização do uso de largura de banda e de redução de atraso na comunicação;
\item Cooperação internacional com outro grupo de pesquisa, através de sanduíche ou co-tutela (mais detalhes na seção \ref{sec:ottawa});
\end{enumerate}

\item \textbf{Implementação do modelo}: visa a criar um protótipo que possa ser utilizado tanto em simulações quanto em execuções reais do modelo proposto;

\begin{enumerate}
\item Implementação da camada de gerenciamento da malha de conexões entre os nodos servidores e entre servidores e clientes;
\item Implementação do módulo de distribuição de carga e gerenciamento de hotspots;
\item Implementação da camada de sincronização da simulação e persistência de estados;
\item Criação e integração do módulo de gerenciamento do uso de recursos do nodo e adaptar a qualidade do jogo à capacidade de cada servidor;
\end{enumerate}

\item \textbf{Simulação e testes}: visa validar o modelo proposto e verificar se os objetivos foram alcançados;

\begin{enumerate}
\item Análise e comparação de simuladores de rede e de sistemas em larga escala, um dos quais será escolhido para realização das simulações do modelo proposto de suporte distribuído a MMOGs;
\item Adaptação do protótipo para que execute sobre o simulador escolhido;
\item Execução dos testes com respeito a: qualidade da comunicação entre nodos adjacentes, eficiência do balanceamento de carga e detecção dos hotspots, consistência da simulação entre os diferentes nodos servidores, disponibilidade do jogo e dos estados dos jogadores mesmo com a presença de falhas;
%TODO: 
\item Testar o protótipo, sobre um sistema em larga escala real, como o Grid5000 \cite{bolze2006gls} e analisar os resultados;
\end{enumerate}

\item \textbf{Escrita do trabalho}: tem por objetivo documentar o trabalho realizado, por meio da tese, além de divulgá-lo, através da escrita e publicação de artigos;

\begin{enumerate}
\item Escrita da tese;
\item Escrita de artigos para publicação nacional (SBGames) e internacional (\mbox{DS-RT}, NetGames), além de periódicos internacionais, como o \emph{Multimedia Tools and Applications}, por exemplo.
\end{enumerate}

\end{enumerate}

%\begin{enumerate}
%
%	\item Revisar as técnicas utilizadas para dar suporte distribuído a jogos MMOG;
%	
%	Será dada continuidade à investigação bibliográfica que já foi iniciada para elaboração deste plano de estudos e pesquisa, além de buscar separá-las em categorias segundo: contexto considerado e problemas que buscam solucionar.
%
%	\item Analisar a aplicabilidade destas técnicas em cenários em que cada nodo do sistema tem recursos mais limitados;
%	
%	Técnicas utilizadas para dar suporte distribuído a jogos MMOG costumam se basear em cenários onde há grande disponibilidade de recursos, com grandes servidores ligados através de rede local com capacidade de comunicação super-dimensionada. Será analisada a viabilidade de serem utilizadas em um contexto onde os nodos têm recursos mais limitados.
%
%	\item Propor integração das mesmas, com otimizações focadas no contexto definido (disponibilidade de super-nodos, ao invés de servidores poderosos);
%	
%	Buscar-se-á fazer aperfeiçoamento de algumas destas técnicas, tendo como ênfase o contexto de super-nodos distribuídos geograficamente e, posteriormente, será proposta uma integração das mesmas% em uma arquitetura de suporte a MMOG
%.
%
%	\item Implementar um protótipo que integre as técnicas estudadas e/ou desenvolvidas nas etapas anteriores;
%
%	\item Efetuar simulações que demonstrem o resultado obtido do trabalho e avaliar seus resultados.
%
%\end{enumerate}

%
%As etapas que esse trabalho seguirão são:
%
%\begin{enumerate}
%
%	\item Dar continuidade à investigação bibliográfica de técnicas de otimização do suporte a jogos MMOG

%	\item Propor uma arquitetura preliminar de suporte a jogos MMOG, que dê ênfase a escalabilidade e a tolerância a falhas;
%
%Tal arquitetura \textbf{provavelmente (bom ou ruim?)} seguirá a vertente de sistema geograficamente distribuído de servidores, apresentada na seção anterior, para distribuir o processamento e a comunicação necessários para a execução de um MMOG.
%
%	\item Buscar algoritmos de particionamento que dividam o mundo virtual entre os nodos de maneira que os jogadores possam ter uma experiência de jogo satisfatória;
%
%Pretende-se evitar o uso de algoritmos que necessitem de informações globais do sistema, de forma que o particionamento e balanceamento de carga possa ser executada com apenas um subconjunto de nodos. Dessa forma, o particionamento dificilmente será ótimo, mas seu tempo de execução estará dentro dos limites do aceitável, e espera-se que tal particionamento consiga uma divisão do mundo que possibilite uma boa experiência de jogo.
%
%	\item Pesquisar uma técnica de sincronização entre os servidores, de forma que o estado dos mesmos - e dos jogadores a eles conectados - tenha consistência satisfatória;
%
%Não se pretende garantir consistência global, pois o estado de cada jogador ou objeto presente no mundo não é necessariamente relevante para todas as outras partes integrantes do ambiente.
%
%	\item Pesquisar técnicas de tolerância a falhas, de forma a tornar o sistema mais robusto;
%	
%Como a simulação será distribuída, haverá diversos pontos suscetíveis a falha, tornando necessário o emprego de alguma técnica de tolerância a falhas que minimize este problema. \textbf{Provavelmente}, serão utilizadas réplicas para cada servidor, cuja finalidade é apenas manter-se atualizada e estar pronta para substituir o nodo servidor original no caso de falha do mesmo.
%
%	\item Integrar os algoritmos e técnicas pesquisados e executar simulações para medir seu desempenho.
%\end{enumerate}

\section{Planejamento dos créditos}

De forma a cumprir os créditos exigidos pelo curso de doutorado, pretende-se:

\begin{enumerate}
\item Revalidar os 24 créditos obtidos durante o curso de mestrado acadêmico no Programa de Pós Graduação em Computação do Instituto de Informática da UFRGS (PPGC/UFRGS). As disciplinas cursadas estão sumarizadas na Tabela \ref{tab:revalidar};
\item Obter 12 créditos adicionais, através do curso das disciplinas CMP182 - Redes de Computadores I B, CMP147 - Redes de Computadores II e CMP200 - Criptografia de Dados;
\item Obter mais 3 créditos, referentes a um trabalho individual e a realização de atividade didática (Tabela \ref{tab:creditos}).
\end{enumerate}

%\begin{table}[!ht]
%\begin{center}
%\caption{Créditos a revalidar}
%\label{tab:revalidar}
%\begin{tabular}{|c||p{5cm}|c|c|c|c|c|c|c|}
%\hline
%Código   & Disciplina                  													& Créditos & Conceito & Professor(a)	\\ \hline \hline
%CMP139   & Tolerância a Falhas em Sistemas Distribuídos 				& 4 & A & Taisy Weber 								\\ \hline
%CMP255   & Prog. Paralela para Processamento de Alto Desempenho & 4 & A & Nicolas Maillard     				\\ \hline
%CMP167   & Programação com Objetos Distribuídos B       				& 4 & A & Cláudio Geyer    						\\ \hline
%CMP256   & Proj. de Prog. Paralelos para Proc. de Alto Desempenho &4& A & Nicolas Maillard       			\\ \hline
%CMP157   & Programação Paralela e Distribuída 									& 4 & A & Cláudio Geyer      					\\ \hline
%CMP250   & Aspectos Conceituais de Tolerância a Falhas 					& 1 & B & Ingrid Jansch-Pôrto  				\\ \hline
%CMP401   & Trabalho Individual I         												& 2 & A & Cláudio Geyer   						\\ \hline
%CMP410   & Atividade Didática I       													& 1 & A & Alexandre Carissimi   			\\ \hline
%\end{tabular}
%\end{center}
%\end{table}

\begin{table}[h]
\begin{center}
\caption{Créditos a revalidar}
\label{tab:revalidar}
\begin{tabular}{|c||p{9cm}|c|c|c|c|c|c|c|}
\hline
Código   & Disciplina                  													& Créditos & Conceito \\ \hline \hline
CMP139   & Tolerância a Falhas em Sistemas Distribuídos 				& 4 & A 						\\ \hline
CMP255   & Prog. Paralela para Processamento de Alto Desempenho & 4 & A   				\\ \hline
CMP167   & Programação com Objetos Distribuídos B       				& 4 & A 					\\ \hline
CMP256   & Proj. de Prog. Paralelos para Proc. de Alto Desempenho &4& A       			\\ \hline
CMP157   & Programação Paralela e Distribuída 									& 4 & A     					\\ \hline
CMP250   & Aspectos Conceituais de Tolerância a Falhas 					& 1 & B   				\\ \hline
CMP401   & Trabalho Individual I         												& 2 & A 					\\ \hline
CMP410   & Atividade Didática I       													& 1 & A   			\\ \hline
\end{tabular}
\end{center}
\end{table}

\begin{table}[h]
\begin{center}
\caption{Créditos a obter}
\label{tab:creditos}
\begin{tabular}{|c||c|c|c|c|c|c|c|c|}
\hline
Código   & Disciplina                  & Créditos \\ \hline \hline
CMP182   & Redes de Computadores I B   & 4        \\ \hline
CMP147   & Redes de Computadores II    & 4        \\ \hline
CMP200   & Criptografia de Dados       & 4        \\ \hline
%CMP260   & Redes P2P: características, protocolos e aplicações & 4        \\ \hline
CMP40(X) & Trabalho Individual         & 2        \\ \hline
CMP411   & Atividade Didática II       & 1        \\ \hline
\end{tabular}
\end{center}
\end{table}

\section{Cooperação internacional}
\label{sec:ottawa}

%Durante a estadia em Vancouver, para apresentação de trabalho no DS-RT -- \emph{IEEE Symposium on Distributed Simulation and Real-Time Applications} -- foram feitos contatos com professores e pesquisadores do SITE (\emph{School of Information Technology and Engineering}), da Universidade de Ottawa, no Canadá. Uma destas pessoas foi o doutorando Dewan Ahmed, que trabalha especificamente com jogos MMOG \cite{ahmed2008dai}. Seu orientador é o professor Shervir Shirmohammadi, que trabalha, dentre outras coisas, com MMOGs e ambientes virtuais e multicast no nível da aplicação com redes overlay. Tem-se mantido contato com este grupo de pesquisa desde então, com o intuito de realizar doutorado sanduíche ou co-tutela, sendo que há interesse de ambas as partes.

%Também  houve conversas com o professor Azzedine Boukerche, também da uOttawa, que trabalha com simulações distribuídas de larga escala, das quais MMOGs seriam um caso específico. Também houve interesse em cooperação por parte desse professor, embora sua pesquisa não seja especificamente com jogos online maciçamente multijogador.

Tem-se mantido contato com o professor Fernando Pedone, da Universidade de Lugano (USI), na Suíça, que trabalha com sistemas distribuídos e sistemas de gerenciamento de dados distribuídos, sendo que há possibilidade de estágio no exterior nessa universidade, com grande interesse dos pesquisadores de ambas as instituições (UFRGS e USI). O intuito do período em uma universidade estrangeira seria o de trocar experiências entre os grupos de pesquisa, de forma a definir um melhor modelo final para o Cosmmus, utilizando \emph{know-how} de outros pesquisadores da área de simulação distribuída e, mais especificamente, MMOGs.



\section{Cronograma}

A Tabela \ref{tab:cronograma} apresenta o cronograma de atividades a serem desenvolvidas, conforme listadas na seção de metodologia.

%\begin{enumerate}
%	\item Levantamento bibliográfico do estado-da-arte das técnicas de distribuição do suporte a MMOG;
%	\item Levantamento bibliográfico de técnicas de distribuição em geral, que possam ser aplicadas a jogos MMOG;
%	\item Análise e categorização destas técnicas;
%	\item Elaboração de um modelo arquitetural de suporte distribuído a jogos MMOG;
%	\item Integração das técnicas no modelo proposto;
%	\item Implementação de um protótipo com o fim de testes;
%	\item Levantamento dos simuladores mais indicados para efetuar tais testes;
%	\item Execução dos testes em um dos simuladores pesquisados;
%	\item Análise dos resultados;
%	\item Apresentação do seminário de andamento na semana acadêmica;
%	\item Escrita da dissertação;
%	\item Escrita de artigos;
%	\item Entrega da dissertação;
%	\item Defesa da dissertação;
%	\item Elaboração de artigo a ser submetido para WSCAD;
%	\item Elaboração de artigo científico relativo ao trabalho já desenvolvido na Dissertação;
%	\item Desenvolvimento do Seminário de Andamento;
%	\item Semana acadêmica;
%	\item Paralelização através do Open-MP;
%	\item Paralelização através do MPI;
%	\item Paralelização através do MPI-2;
%	\item Comparação de resultados;
%	\item Redação da dissertação;
%	\item Elaboração de artigo a ser submetido em evento da área (Alto desempenho e Física computacional);
%	\item Entrega da dissertação;
%	\item Defesa da dissertação
%\end{enumerate}

\begin{table}[!ht]

\begin{center}
\caption{Cronograma}
\label{tab:cronograma}
\begin{tabular}{|c||c|c|c|c|c|c|c|c|}
\hline
Etapa 
   &2009/1&2009/2&2010/1&2010/2&2011/1&2011/2&2012/1&2012/2\\ \hline \hline
1a &  X   &      &      &      &      &      &      &      \\ \hline
1b &  X   &  X   &      &      &      &      &      &      \\ \hline
1c &      &  X   &      &      &      &      &      &      \\ \hline
1d &      &      &  X   &      &  X   &      &  X   &      \\ \hline
1e &      &      &  X   &      &      &      &      &      \\ \hline
1f &      &      &      &  X   &      &      &      &      \\ \hline \hline

%\hline\hline
2a &  X   &      &      &      &      &      &      &      \\ \hline
2b &  X   &      &      &      &      &      &      &      \\ \hline
2c &  X   &      &      &      &      &      &      &      \\ \hline
2d &  X   &      &      &      &      &      &      &      \\ \hline
2e &      &  X   &      &      &      &      &      &      \\ \hline
2f &      &  X   &      &      &      &      &      &      \\ \hline
2g &      &  X   &  X   &      &      &      &      &      \\ \hline \hline

%\hline\hline
3a &      &  X   &      &      &      &      &      &      \\ \hline
3b &      &  X   &      &      &      &      &      &      \\ \hline
3c &      &      &  X   &      &      &      &      &      \\ \hline
3d &      &      &  X   &      &      &      &      &      \\ \hline
3e &      &      &  X   &      &      &      &      &      \\ \hline
3f &      &  X   &  X   &      &      &      &      &      \\ \hline \hline

%\hline\hline
4a &      &      &      &  X   &      &      &      &      \\ \hline
4b &      &      &      &  X   &      &      &      &      \\ \hline
4c &      &      &      &      &  X   &      &      &      \\ \hline
4d &      &      &      &      &  X   &      &      &      \\ \hline \hline

%\hline\hline
5a &      &      &      &      &      &  X   &      &      \\ \hline
5b &      &      &      &      &      &  X   &      &      \\ \hline
5c &      &      &      &      &      &  X   &      &      \\ \hline
5d &      &      &      &      &      &  X   &  X   &      \\ \hline \hline

%\hline\hline
6a &      &      &      &      &      &      &  X   &  X   \\ \hline
6b &      &      &  X   &  X   &  X   &  X   &      &      \\ \hline
\end{tabular}
\end{center}
\end{table}


%\chapter{Informações do candidato}
%\section{Dados de identificação}
\chapter{Experiência com pesquisa}

%papers
%inge
%watc...? (sim, como resultado prático, citando premiação)
%eventos em que participou
%TODO: ref do K-L, ref do indigente

Antes de realizar o mestrado acadêmico, o candidato já havia trabalhado com pesquisa e desenvolvimento, no grupo indigente \cite{indigente}, sendo um dos idealizadores e desenvolvedor do motor para jogos InGE -- \emph{indigente game engine} -- \cite{rocha2007dmm}, tendo sido o único responsável pelo módulo de rede. Posteriormente, foi um dos desenvolvedores do jogo \emph{We Are The Champignons}, que obteve premiação em um festival de jogos de âmbito nacional.

O curso de doutorado pretendido terá por objetivo dar continuidade à pesquisa iniciada no mestrado acadêmico pelo PPGC/UFRGS, entre os anos de 2007 a 2009, sendo a defesa da dissertação prevista para fevereiro de 2009. Durante o mestrado, foram propostas algumas técnicas que visam a otimizar o uso de largura de banda em um sistema distribuído atuando como servidor para um jogo online maciçamente jogador. Uma destas técnicas consiste no gerenciamento de interesse do jogador, levando em conta diferentes níveis de relevância para diferentes entidades do jogo. Outra técnica proposta é a de balanceamento de carga dinâmico, baseado em particionamento de grafo e refinamento de suas partições \cite{kernighan1970ehp}. Este trabalho está em fase de conclusão, faltando coletar os resultados e escrever artigo para publicar no journal \emph{Multimedia Tools and Applications}, da Springer, que terá uma edição especial a respeito de MMOGs a ser publicada em 2009.

O candidato também participou do projeto P2PSE \cite{vilanova2008psm}, sendo um dos responsáveis pelo desenvolvimento da funcionalidade de multi-servidor, utilizando linguagem de programação C++. Também é o responsável pelas simulações de rede, realizadas com o auxílio do simulador ns-2 \cite{mccanne:nsn}, presentes no artigo publicado em simpósio nacional a respeito do mesmo projeto.

Tais trabalhos desenvolvidos durante o curso de mestrado acadêmico, além do envolvimento anterior com pesquisa e desenvolvimento, renderam algumas publicações e uma premiação:

\begin{itemize}

\item Full paper, em periódico internacional:

\textbf{A load balancing scheme for massively multiplayer online games}, BEZERRA, Carlos Eduardo B.; CECIN, Fábio R.; GEYER, Cláudio F. R., em \emph{Multimedia Tools and Applications}, 2009, Springer Netherlands.

\item Full paper, em simpósio internacional:

\textbf{A${^3}$: a novel interest management algorithm for distributed simulations of MMOGs}, BEZERRA, Carlos Eduardo B.; CECIN, Fábio R.; GEYER, Cláudio F. R., em \emph{Proc. of the 12-th IEEE International Symposium on Distributed Simulation and Real Time Applications}, 2008, Vancouver, BC, Canada.

\item Full paper, em simpósio nacional:

\textbf{P2PSE - A peer-to-peer support for multiplayer games}, VILANOVA, Felipe J.; BEZERRA, Carlos Eduardo B.; CRIPPA, Marcos R., CECIN, Fábio R.; GEYER, Cláudio F. R., em \emph{Proc. of SBGames 2008 - VII Brazilian Symposium on Computer Games and Digital Entertainment - Computing Track}, 2008, Belo Horizonte, MG, Brazil.

\item Short paper, em simpósio nacional, a respeito do desenvolvimento do InGE:

\textbf{Desenvolvendo um Motor Multiplataforma para Jogos 3D}, ROCHA, Rodrigo; BESSA, Aline; BEZERRA, Carlos E. B.; MEDEIROS, Ivan; OLIVEIRA, Caio; BANDEIRA, H., em \emph{Anais do SBGames 2007 - VI Simpósio Brasileiro de Jogos para Computador e Entretenimento Digital - Trilha Computação}, 2007, São Leopoldo, RS, Brazil.

\item 3º lugar no Festival de Jogos Independentes do SBGames 2006:

\textbf{We Are The Champignons}, \emph{V Simpósio Brasileiro de Jogos para Computador e Entretenimento Digital}, 2006, Recife, PE, Brasil.

\end{itemize}

Para o curso de doutorado, o candidato pretende criar um modelo mais detalhado que cubra os requisitos definidos para o sistema servidor distribuído. Pelo menos devem ser satisfeitos os requisitos de distribuição da persistência do estado dos jogadores e do mundo virtual, da sincronização da simulação distribuída entre os nodos servidores, provendo também tolerância a falhas, além de desenvolver técnicas que otimizem tanto quanto possível o uso de largura de banda, evitando que a qualidade do jogo seja prejudicada.

\bibliography{planodoc}
\bibliographystyle{abnt} 



















% 
% 
% 
% 
% \chapter*{Assinaturas}
% 
% 
% 
% \vspace{2cm}
% 
% 
% 
% \begin{center}
% \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_  \\
% Carlos Eduardo Benevides Bezerra
% 
% 
% \vspace{4cm}
% 
% 
% 
% \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_  \\
% Prof.~Dr. Cláudio Fernando Resin Geyer
% 
% \end{center}


\end{document}
