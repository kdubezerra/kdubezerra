%% LaTeX Beamer presentation template (requires beamer package)
%% see http://latex-beamer.sourceforge.net/
%% idea contributed by H. Turgut Uyar
%% template based on a template by Till Tantau
%% this template is still evolving - it might differ in future releases!

\newcommand{\bval}{$B_{val}$}
\newcommand{\bqrm}{$B_{qrm}$}
\newcommand{\bvot}{$B_{vot}$}
\newcommand{\bbal}{$B_{bal}$}
\newcommand{\bvalm}{B_{val}}
\newcommand{\bqrmm}{B_{qrm}}
\newcommand{\bvotm}{B_{vot}}
\newcommand{\bbalm}{B_{bal}}
\newcommand{\vp}{$v_{p}$}
\newcommand{\vval}{$v_{val}$}
\newcommand{\vbal}{$v_{bal}$}
\newcommand{\votesbeta}{$\text{\textit{Votes}}(\beta)$}
\newcommand{\maxvotep}{\textit{MaxVote(b, p, $\beta$)}}
\newcommand{\maxvoteq}{\textit{MaxVote(b, Q, $\beta$)}}
\DeclareMathAlphabet{\mathpzc}{OT1}{pzc}{m}{it}
\DeclareMathAlphabet{\mathcalligra}{T1}{calligra}{m}{n}

\documentclass{beamer}

\mode<presentation>
{
\usetheme{Warsaw}
\usecolortheme{seagull}

%\usecolortheme{dolphin}
%\usecolortheme{seahorse}
%\usecolortheme{albatross}
\setbeamercovered{transparent}
}


\usepackage[english]{babel}
\usepackage[utf8]{inputenc}

% font definitions, try \usepackage{ae} instead of the following
% three lines if you don't like this look

\usepackage{mathptmx}
\usepackage[scaled=.90]{helvet}
\usepackage{courier}
\usepackage{chancery}
\usepackage{mathrsfs}
\usepackage{amsmath}
\usepackage{upgreek}


\usepackage[T1]{fontenc}


%\title{The Part-Time Parliament}
\title[{\makebox[.45\paperwidth]{The Part-Time Parliament\hfill\insertframenumber/\inserttotalframenumber}}]{The Part-Time Parliament} 
\subtitle{Leslie Lamport, 1998}

% - Use the \inst{?} command only if the authors have different
%   affiliation.
%\author{F.~Author\inst{1} \and S.~Another\inst{2}}
\author{Carlos Eduardo B. Bezerra}

% - Use the \inst command only if there are several affiliations.
% - Keep it simple, no one is interested in your street address.
\institute[Universities of]
{
Faculty of Informatics\\
Universitt√† della Svizzera italiana
}

\date{May 25th, 2011}


% This is only inserted into the PDF information catalog. Can be left
% out.
\subject{Talks}



% If you have a file called "university-logo-filename.xxx", where xxx
% is a graphic format that can be processed by latex or pdflatex,
% resp., then you can add a logo as follows:

% \pgfdeclareimage[height=0.5cm]{university-logo}{university-logo-filename}
% \logo{\pgfuseimage{university-logo}}



% % Delete this, if you do not want the table of contents to pop up at
% % the beginning of each subsection:
% %\AtBeginSubsection[]
% %{
% %\begin{frame}<beamer>
% %\frametitle{Outline}
% %\tableofcontents[currentsection,currentsubsection]
% % %\end{frame}
%}

% If you wish to uncover everything in a step-wise fashion, uncomment
% the following command:

%\beamerdefaultoverlayspecification{<+->}

\begin{document}



\begin{frame}
  \titlepage
\end{frame}



\begin{frame}
  \frametitle{Outline}
  \tableofcontents
  % You might wish to add the option [pausesections]
\end{frame}



%==========================================================
\section{Introduction}
%==========================================================

%----------------------------------------------------------
\subsection{A long way to Paxos}
%----------------------------------------------------------

\begin{frame}
  \frametitle{Introduction}

  Interesting information about `The Part-Time Parliament':
  
  \begin{itemize}
    \item the algorithm was first described in 1989 as a technical report [1]
    \item the paper was submitted in 1990\ldots and accepted in 1998%people just couldn't understand it!
    \item several other publications, such as [2, 3, 4], had explaining it as their main purpose\ldots
  \end{itemize}

\end{frame}



\begin{frame}

  The paper mostly uses an analogy with the fictional ancient island of Paxos, where:
  \begin{itemize}
    \item The parliament's (group's) legislators (processes) and their messengers (communication channels) may be unpredictably absent;
    \item There may be several ballots for each decree to be passed (rounds in each consensus instance);
    \item Legislators -- and messengers -- may be lazy or absent, but not dishonest (non-Byzantine failure model*)
  \end{itemize}
  \vspace{6 mm}
  {\small * The algorithm was extended later, however, to tolerate Byzantine failures [5]}
\end{frame}




%==========================================================
\subsection{The consensus problem}
%==========================================================


\begin{frame}
  \frametitle{Definition}
  
  \textbf{Consensus} is the process of agreeing on one single result among a group of participants. Assuming a collection of processes that can propose values, a consensus algorithm ensures that:
  
  \begin{itemize}
    \item only a single value among the proposed ones may be chosen;
    \item if no value has been proposed, then no value is chosen;
    \item a process never learns that a value has been chosen unless it really has been.
  \end{itemize}

%A process may be unaware of a given chosen value, as long as it doesn't learn an invalid one

%These properties guarantee consistency (safety), but not progress (liveness)
%Hard because of assuming the possibility of process failures\ldots

\end{frame}



%==========================================================
\section{The Paxos Algorithm}
%==========================================================

%----------------------------------------------------------
\subsection{Notations used}
%----------------------------------------------------------


\begin{frame}
  \frametitle{The Paxos algorithm}
  \framesubtitle{Some notations used}
  
  A value is chosen after a series of numbered \textbf{ballots}. For each ballot $B$, we have that:
  \begin{itemize}
    \item \bbal\ is its ballot number; %loosely related to its order
    \item \bqrm\ is a nonempty finite set of processes (quorum);
    \item \bvot\ is the set of processes who voted in $B$ -- each process may decide to participate (vote) or not in $B$;
    \item \bval\ is the value being voted on in that ballot.
  \end{itemize}
  
  \vspace{4 mm}
  A ballot is said to be \emph{successful} when \bqrm\ $\subseteq$ \bvot\ -- which means that every quorum member voted.

\end{frame}

\begin{frame}
  \frametitle{The Paxos algorithm}
  \framesubtitle{Some more notations}
  
  In each ballot, each process can cast a vote (accept or not a given proposed value). A vote $v$ has the components:

  \begin{itemize}
    \item \vp, which is the process $p$ who cast it;
    \item \vbal, the number of the ballot for which it was cast;
    \item \vval, a value voted on.
  \end{itemize}
  
  \vspace{4 mm}
 % A \emph{null} vote $v$ is that for which \vbal\ $=$ $-\infty$ and \vval\ $=$ BLANK. 
 For the set $\beta$ of ballots, the set \votesbeta\ is defined as\\
 $\{v$ : $\exists B$ $\in$ $\beta$ | \vp\ $\in$ \bvot\ $\wedge$ \vbal\ $=$ \bbal\ $\wedge$ \vval\ $=$ \bval\ $\}$ 

\end{frame}

\begin{frame}
  \frametitle{The Paxos algorithm}
  \framesubtitle{Still more notations\ldots}

  We then define \maxvotep\ as the vote $v$ with highest \vbal\ in 
 $\{v \in Votes(\beta) : (v_p = p) \wedge (v_{bal} < b)\} \cup \{null\}$,\\
 where $null$ means that $p$ didn't vote in any $B \in \beta$ ($null_{bal} = -\infty$)

  \vspace{4 mm}
  We also define \maxvoteq\ as the vote $v$, such that \vbal\ is the highest among all \maxvotep\ with $p \in Q$

  \vspace{8 mm}
  {\small With such notations, we can specify the conditions which ensure consistency and allow for progress.}

\end{frame}

%----------------------------------------------------------
\subsection{Consistency conditions}
%----------------------------------------------------------


\begin{frame}
  \frametitle{Consistency conditions}

  Consistency is guaranteed if the following conditions are ensured:

  \begin{itemize}
    \item $B1(\beta)$
    
    $\forall B, B' \in \beta : (B \neq B') \Rightarrow (\bbalm \neq B'_{bal})$

    \vspace{4 mm}
    \item $B2(\beta)$ %B2 may be ensured by always picking a majority of processes as quorum, which implies that n > 2f (a majority is correct for each instance)
  
    $\forall B, B' \in \beta : \bqrmm \cap B'_{qrm} \neq \emptyset)$
    
    \vspace{4 mm}
    \item $B3(\beta)$
  
    $\forall B, B' \in \beta :$\\
    $(\text{\textit{MaxVote}}(\bbalm, \bqrmm, \beta)_{bal} \neq -\infty) \Rightarrow$\\
    $\Rightarrow (\bvalm = \text{\textit{MaxVote}}(\bbalm, \bqrmm, \beta)_{val})$
  \end{itemize}

\end{frame}



%----------------------------------------------------------
\subsection{Proof sketch}
%----------------------------------------------------------


\begin{frame}
\frametitle{Proof sketch}

\textsc{\textbf{Lemma}}. If $B1(\beta)$, $B2(\beta)$ and $B3(\beta)$ hold, then $$((\bqrmm \subseteq \bvotm) \wedge (B'_{bal} > \bbalm)) \Rightarrow (B'_{val} = \bvalm)$$ for any $B$, $B'$ in $\beta$.

\vspace{3 mm}
\textsc{\textbf{Proof of Lemma}}. Let $\uppsi(B, \beta)$ be defined as: $$\uppsi(B, \beta) = \{B' \in \beta : (B'_{bal} > \bbalm) \wedge (B'_{val} \neq \bvalm)\}$$


Assume that $\bqrmm \subseteq \bvotm$. By contradiction, assume that $\uppsi(B, \beta) \neq \emptyset$.

\vspace{3 mm}
(1) As $\uppsi(B, \beta) \neq \emptyset$, we have that $\exists C : C_{bal} = min\{B'_{bal} : B' \in \uppsi(B, \beta)\}$

(2) From (1) and from the definition of $\uppsi(B, \beta)$, we have that $C_{bal} > \bbalm$

\end{frame}

\begin{frame}
\frametitle{Proof sketch}
\framesubtitle{continuing\ldots}

(3) As $\bqrmm \subseteq \bvotm$ and $\forall B, B' \in \beta : \bqrmm \cap B'_{qrm} \neq \emptyset$, we have that $\bvotm \cap C_{qrm} \neq \emptyset$

\vspace{2 mm}
(4) As $C_{bal} > \bbalm$ and $\bvotm \cap C_{qrm} \neq \emptyset$, we have that \textit{MaxVote}$(C_{bal}, C_{qrm}, \beta)_{bal} \geq \bbalm$

\vspace{2 mm}
(5) From (4) and the definition of \textit{MaxVote}$(C_{bal}, C_{qrm}, \beta)$, we know that such vote exists in \textit{Votes}$(\beta)$ (i.e. it is not $null$).

\vspace{2 mm}
(6) From (5) and $B3(\beta)$, we have that \textit{MaxVote}$(C_{bal}, C_{qrm}, \beta)_{val} = C_{val}$

\vspace{2 mm}
(7) From (6), and as $C_{val} \neq \bvalm$ (from $\uppsi(B, \beta$)), we have that \textit{MaxVote}$(C_{bal}, C_{qrm}, \beta)_{val} \neq \bvalm$

\end{frame}

\begin{frame}
% You can create overlays
\begin{itemize}
  \item using the \texttt{pause} command:
  \begin{itemize}
    \item First item.
    \pause
    \item Second item.
  \end{itemize}
  \item using overlay specifications:
  \begin{itemize}
    \item<3-> First item.
    \item<4-> Second item.
  \end{itemize}
  \item using the general \texttt{uncover} command:
  \begin{itemize}
    \uncover<5->{\item First item.}
    \uncover<6->{\item Second item.}
  \end{itemize}
\end{itemize}
\end{frame}



%==========================================================
\section*{Summary}
%==========================================================


\begin{frame}
\frametitle<presentation>{Summary}

\begin{itemize}
  \item The \alert{first main message} of your talk in one or two lines.
\end{itemize}

% The following outlook is optional.
\vskip0pt plus.5fill
\begin{itemize}
  \item Outlook
  \begin{itemize}
    \item Something you haven't solved.
    \item Something else you haven't solved.
  \end{itemize}
\end{itemize}

\end{frame}



%==========================================================
\section*{References}
%==========================================================


\begin{frame}
  \frametitle{References}

[1] Lamport, L. \textbf{The part-time parliament}, Technical Report 49, Systems Research Center, Digital Equipment Corp., 1989
\vspace{4 mm}

[2] Lamport, L. \textbf{Paxos Made Simple}, ACM SIGACT News, 2001
\vspace{4 mm}

[3] De Prisco, R., Lampson, B., Lynch, N. \textbf{Revisiting the Paxos Algorithm}, Distributed Algorithms, 1997
\vspace{4 mm}

[4] Lampson, B. \textbf{How to build a highly available system using consensus}, Distributed Algorithms, 1996
\vspace{4 mm}

[5] Castro, M., Liskov, B., \textbf{Practical Byzantine Fault Tolerance}, Operating Systems Design and Implementation, 1999
  
\end{frame}



\end{document}
